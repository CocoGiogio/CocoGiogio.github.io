<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Agent T - W4RSH3LL</title>

    <!-- Styles -->
    <link rel="stylesheet" href="../../../css/style.css" />
    <link rel="stylesheet" href="../../../css/write_up.css" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../../../assets/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="../../../assets/favicon.svg" />
    <link rel="shortcut icon" href="../../../assets/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="../../../assets/apple-touch-icon.png" />
    <link rel="manifest" href="../../../assets/site.webmanifest" />
</head>

<body>

    <!-- Background -->
    <div class="background-overlay"></div>
    <div class="particles"></div>

    <!-- Navigation -->
    <nav>
        <div class="logo-container">
            <img src="../../../assets/leviathan_profil_pic.jpg" alt="W4RSH3LL Avatar" class="avatar" />
            <span class="logo-text">W4RSH3LL</span>
            <button class="menu-toggle" aria-label="Toggle menu">&#9776;</button>
        </div>

        <ul class="menu">
            <li><a href="../../../index.html">Home</a></li>
            <li><a href="../../../html/about.html">About</a></li>
            <li><a href="../../../html/projects.html">Projects</a></li>
            <li><a href="../../../html/certifications.html">Certifications</a></li>
            <li><a href="../../../html/documentations.html">Documentations</a></li>
            <li><a href="../../../html/write-ups.html" class="active">Write-ups</a></li>
            <li><a href="../../../html/skills.html">Skills</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main>
        <section class="report-section">

            <h1 class="section-title">Agent T - Write-up</h1>
            <img src="../agent_t/assets/logo.png">

            <!-- Overview -->
            <h2>Machine Overview</h2>
            <ul>
                <li><strong>Title:</strong> Agent T</li>
                <li><strong>Description:</strong> Something seems a little off with the server.</li>
                <li><strong>Target IP:</strong> 10.10.57.138</li>
                <li><strong>Difficulty:</strong> Easy</li>
            </ul>
            <hr>

            <h2>Important Notes</h2>
            <ul>
                <li><strong>Host:</strong> source.unsplash.com</li>
                <li><strong>PHP Version:</strong> PHP 8.1.0-dev</li>
            </ul>
            <hr>

            <!-- Nmap -->
            <h2>Nmap Port Scan</h2>

            <h3>Scan #1</h3>
            <pre><code>nmap 10.10.57.138</code></pre>
            <h3>Output:</h3>
            <pre><code>80/tcp open  http</code></pre>

            <h3>Scan #2</h3>
            <pre><code>nmap -A 10.10.57.138</code></pre>
            <h3>Output:</h3>
            <pre><code>80/tcp open  http    PHP cli server 5.5 or later (PHP 8.1.0-dev)
                |_http-title:  Admin Dashboard</code></pre>

            <h3>Scan #3</h3>
            <pre><code>nmap -p- 10.10.57.138</code></pre>
            <h3>Output:</h3>
            <pre><code>80/tcp open  http</code></pre>

            <hr>
            <!-- Enumeration -->
            <h2>Exploring Port 80 (HTTP)</h2>
            <p>When we browse to the target's IP on Port 80, we land on what seems to be an Admin Dashboard.</p>

            <figure>
                <img src="../agent_t/assets/Pasted image 20251117194621.png" alt="">
            </figure>

           <p>After browsing through the available pages, it's almost as if the website was breaking.
            For example, browsing back to the main page which was *index.html* caused a 404 error.</p>

            <h3>Burpsuite</h3>
            <p>When using Burpsuite to inspect the HTTP Responses, we notice something is off.</p>
            <p>First, in the URL, I have requested for:</p>

            <img src="../agent_t/assets/Pasted image 20251117200109.png" alt="">
            <p>Then, I analyzed the requests it was doing on Burpsuite.</p>

            <p>This is the first request that happens:</p>
            <img src="../agent_t/assets/Pasted image 20251117200155.png" atl="">

            <p>Then this second odd request happens:</p>
            <img src="../agent_t/assets/Pasted image 20251117200230.png" atl="">

            <p><strong>
                <ul>
                    <li>GET /a_string_of_random_chars HTTP/2</li>
                    <li>Host: source.unsplash.com</li>
                </ul>
            </strong></p>
            <hr>

            <p>Then, when we go to source.unsplash.com we land on this Application Error Page:</p>
            <img src="../agent_t/assets/Pasted image 20251117201414.png" atl="">

            <p>After looking online Heruko is:
                <strong>Heroku</strong> is a cloud platform as a service (PaaS) supporting several programming languages. As one of the first cloud platforms "Cloud computing", Heroku has been in development since June 2007, when it supported only the Rubyprogramming language, but now also supports Java , Node.js, Scala, Clojure, Python, PHP and Go. For this reason, Heroku is said to be a polyglot platform computing as it has features for a developer to build, run and scale applications in a similar manner across most of these languages. Heroku was acquired by Salesforce in 2010 for $212 million.
            </p>
            <hr>
            <h2>Gaining a foothold</h2>
            <p>After looking online, I found a python exploit for php PHP 8.1.0-dev.
                Apparently, in this developper version, there was a pre installed backdoor that could be triggered if we sent the header parameter in our request.
            </p>
            <a href="https://flast101.github.io/php-8.1.0-dev-backdoor-rce/">Details on the Backdoor</a>
            <p>If "zerodium" is in the HTTP_USER_AGENT parameter, we could obtain a connection back to our attacker machine.</p>
            <p>After running this python script, we get full root access to the system.
                From here, we can capture the flag:</p>

            <img src="../agent_t/assets/Pasted image 20251117212046.png" atl="">
        </section>
    </main>

    <!-- Footer -->
    <footer id="footer">
        <div class="footer-container">
            <p>&copy; 2025 W4RSH3LL. All rights reserved.</p>

            <div class="footer-links">

                <!-- Email -->
                <a href="mailto:w4rsh3ll@pm.me" class="footer-link" title="Email">
                    <svg class="footer-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 
                        1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 
                        2-2zm0 2v.01L12 13l8-6.99V6H4zm0 
                        12h16V8l-8 6-8-6v10z"/>
                    </svg>
                    <span>w4rsh3ll@pm.me</span>
                </a>

                <!-- GitHub -->
                <a href="https://github.com/w4rsh3ll" target="_blank" class="footer-link" title="GitHub">
                    <svg class="footer-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0C5.37 0 0 5.37 0 
                        12c0 5.3 3.438 9.8 8.205 
                        11.387.6.113.82-.26.82-.577v-2.256c-3.338.726-4.033-1.61-4.033-1.61-.546-1.387-1.333-1.757-1.333-1.757-1.09-.745.083-.729.083-.729 
                        1.205.085 1.84 1.236 1.84 
                        1.236 1.07 1.834 2.807 1.304 
                        3.492.997.108-.775.418-1.304.762-1.604-2.665-.304-5.466-1.332-5.466-5.93 
                        0-1.31.467-2.38 1.235-3.22-.123-.303-.535-1.523.117-3.176 
                        0 0 1.008-.322 3.301 1.23a11.52 
                        11.52 0 0 1 3.003-.404c1.02.005 
                        2.047.138 3.004.404 2.291-1.552 
                        3.297-1.23 3.297-1.23.655 1.653.243 
                        2.873.12 3.176.77.84 1.232 
                        1.91 1.232 3.22 0 4.61-2.807 
                        5.624-5.48 5.922.43.37.823 1.102.823 
                        2.222v3.293c0 .32.217.694.825.576A12.01 
                        12.01 0 0 0 24 12c0-6.63-5.37-12-12-12z"/>
                    </svg>
                    <span>github.com/w4rsh3ll</span>
                </a>

                <!-- TryHackMe -->
                <a href="https://tryhackme.com/p/W4RSH3LL" target="_blank" class="footer-link" title="TryHackMe">
                    <svg class="footer-icon" viewBox="0 0 46.069 46.069" fill="currentColor">
                        <g>â€¦</g>
                    </svg>
                    <span>tryhackme.com/W4RSH3LL</span>
                </a>

            </div>
        </div>
    </footer>
    <script src="../../../js/script.js"></script>
</body>
</html>
